\hypertarget{_control__system_8h_source}{}\doxysection{Control\+\_\+system.\+h}
\label{_control__system_8h_source}\index{C:/Users/juanh/OneDrive/Escritorio/Facultad/Beca/Proyecto/LAL\_Control/include/Control\_system.h@{C:/Users/juanh/OneDrive/Escritorio/Facultad/Beca/Proyecto/LAL\_Control/include/Control\_system.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef CONTROL\_SYSTEM\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define CONTROL\_SYSTEM\_H}}
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_subject_8h}{observer\_pattern/subjects/Subject.h}}"{}}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_machine_8h}{machine\_state\_pattern/Machine.h}}"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_display_8h}{drivers/Display.h}}"{}}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{user__messages_8h}{user\_messages.h}}"{}}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_system__observer_8h}{observer\_pattern/observers/System\_observer.h}}"{}}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_temperature__sensor_8h}{drivers/Temperature\_sensor.h}}"{}}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_moisture__sensor_8h}{drivers/Moisture\_sensor.h}}"{}}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{types_8h}{types.h}}"{}}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_buzzer_8h}{drivers/Buzzer.h}}"{}}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_motor_8h}{drivers/Motor.h}}"{}}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_dual___l_e_d_8h}{drivers/Dual\_led.h}}"{}}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_cooler_8h}{drivers/Cooler.h}}"{}}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_shutdown__state_8h}{machine\_state\_pattern/machine\_states/Shutdown\_state.h}}"{}}}
\DoxyCodeLine{17 \textcolor{keyword}{class }\mbox{\hyperlink{class_control__system}{Control\_system}} : \textcolor{keyword}{public} \mbox{\hyperlink{class_subject}{Subject}}, \textcolor{keyword}{public} \mbox{\hyperlink{class_machine}{Machine}}}
\DoxyCodeLine{18 \{}
\DoxyCodeLine{19     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{class_idle__state}{Idle\_state}};}
\DoxyCodeLine{20     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{class_motor__control__state}{Motor\_control\_state}};}
\DoxyCodeLine{21     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{class_shutdown__state}{Shutdown\_state}};}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{keyword}{public}:}
\DoxyCodeLine{24     \textcolor{keywordtype}{void} init();}
\DoxyCodeLine{25     \textcolor{keywordtype}{void} handle\_alarm()}
\DoxyCodeLine{26     \{}
\DoxyCodeLine{27         \textcolor{keywordflow}{switch} (this-\/>context.current\_alarm)}
\DoxyCodeLine{28         \{}
\DoxyCodeLine{29         \textcolor{keywordflow}{case} OVERTEMP\_ALARM:}
\DoxyCodeLine{30             this-\/>context.shutdown\_request = \textcolor{keyword}{true};}
\DoxyCodeLine{31             this-\/>show\_error\_msg();}
\DoxyCodeLine{32             \textcolor{keywordflow}{break};}
\DoxyCodeLine{33 }
\DoxyCodeLine{34         \textcolor{keywordflow}{case} HUMIDITY\_ALARM:}
\DoxyCodeLine{35             this-\/>context.shutdown\_request = \textcolor{keyword}{true};}
\DoxyCodeLine{36             this-\/>show\_error\_msg();}
\DoxyCodeLine{37             \textcolor{keywordflow}{break};}
\DoxyCodeLine{38         \textcolor{keywordflow}{case} HALTED\_FAN\_ALARM:}
\DoxyCodeLine{39             this-\/>context.shutdown\_request = \textcolor{keyword}{true};}
\DoxyCodeLine{40             this-\/>show\_error\_msg();}
\DoxyCodeLine{41             \textcolor{keywordflow}{break};}
\DoxyCodeLine{42         \textcolor{keywordflow}{case} NO\_TEMP\_SENSOR\_ALARM:}
\DoxyCodeLine{43             this-\/>show\_error\_msg();}
\DoxyCodeLine{44             this-\/>context.shutdown\_request = \textcolor{keyword}{true};}
\DoxyCodeLine{45         \textcolor{keywordflow}{case} OVERTEMP\_WARNING:}
\DoxyCodeLine{46             \textcolor{keywordflow}{break};}
\DoxyCodeLine{47         \textcolor{keywordflow}{case} SLOW\_FAN\_WARNING:}
\DoxyCodeLine{48             \textcolor{keywordflow}{break};}
\DoxyCodeLine{49         \textcolor{keywordflow}{case} NO\_ALARM:}
\DoxyCodeLine{50             \textcolor{keywordflow}{break};}
\DoxyCodeLine{51         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{52             this-\/>display.\mbox{\hyperlink{class_display_a87d1e7bf73a1d14b5e76c9ab647a9e93}{set\_text}}(\textcolor{stringliteral}{"{}No se reconociÃ³ el error"{}});}
\DoxyCodeLine{53             \textcolor{keywordflow}{break};}
\DoxyCodeLine{54         \}}
\DoxyCodeLine{55     \}}
\DoxyCodeLine{56     \textcolor{keywordtype}{void} update();}
\DoxyCodeLine{57     \textcolor{keywordtype}{void} wake()}
\DoxyCodeLine{58     \{}
\DoxyCodeLine{59         this-\/>context.shutdown\_request = \textcolor{keyword}{false};}
\DoxyCodeLine{60     \};}
\DoxyCodeLine{61     \textcolor{keywordtype}{bool} is\_off()}
\DoxyCodeLine{62     \{}
\DoxyCodeLine{63         \textcolor{keywordflow}{return} this-\/>context.shutdown\_request;}
\DoxyCodeLine{64     \}}
\DoxyCodeLine{65     \textcolor{keywordtype}{void} reset\_context()}
\DoxyCodeLine{66     \{}
\DoxyCodeLine{67         this-\/>context.alarm\_request = \textcolor{keyword}{false};}
\DoxyCodeLine{68         this-\/>context.warning\_request = \textcolor{keyword}{false};}
\DoxyCodeLine{69         this-\/>context.current\_step = 0;}
\DoxyCodeLine{70         this-\/>context.current\_alarm = NO\_ALARM;}
\DoxyCodeLine{71         this-\/>context.override\_next\_step = \textcolor{keyword}{false};}
\DoxyCodeLine{72         this-\/>context.shutdown\_request = \textcolor{keyword}{false};}
\DoxyCodeLine{73         this-\/>context.warning\_request = \textcolor{keyword}{false};}
\DoxyCodeLine{74         this-\/>context.next\_step\_request = \textcolor{keyword}{false};}
\DoxyCodeLine{75     \}}
\DoxyCodeLine{76     \textcolor{keywordtype}{void} count\_cooler\_rotation()}
\DoxyCodeLine{77     \{}
\DoxyCodeLine{78         \textcolor{keywordflow}{if} (this-\/>front\_cooler.rotation\_detected() == HIGH)}
\DoxyCodeLine{79         \{}
\DoxyCodeLine{80             this-\/>front\_cooler.count\_rotation();}
\DoxyCodeLine{81         \}}
\DoxyCodeLine{82     \}}
\DoxyCodeLine{83     \textcolor{keywordtype}{void} show\_current\_step()}
\DoxyCodeLine{84     \{}
\DoxyCodeLine{85         \textcolor{keywordtype}{char} buf[MAX\_MESSAGE\_LENGTH];}
\DoxyCodeLine{86         strncpy\_P(buf, PROCEDURE\_MESSAGES[this-\/>context.current\_step], MAX\_MESSAGE\_LENGTH);}
\DoxyCodeLine{87         this-\/>display.\mbox{\hyperlink{class_display_a87d1e7bf73a1d14b5e76c9ab647a9e93}{set\_text}}(buf);}
\DoxyCodeLine{88     \}}
\DoxyCodeLine{89     \textcolor{keywordtype}{void} show\_error\_msg()}
\DoxyCodeLine{90     \{}
\DoxyCodeLine{91         \textcolor{keywordtype}{char} buf[MAX\_MESSAGE\_LENGTH];}
\DoxyCodeLine{92         strncpy\_P(buf, ERROR\_MESSAGES[this-\/>context.current\_alarm], MAX\_MESSAGE\_LENGTH);}
\DoxyCodeLine{93         this-\/>display.\mbox{\hyperlink{class_display_a87d1e7bf73a1d14b5e76c9ab647a9e93}{set\_text}}(buf);}
\DoxyCodeLine{94     \}}
\DoxyCodeLine{95     \textcolor{keywordtype}{void} next\_step();}
\DoxyCodeLine{96     \textcolor{keywordtype}{void} print(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *string\_out);}
\DoxyCodeLine{97     \textcolor{keywordtype}{void} init\_display();}
\DoxyCodeLine{98     \mbox{\hyperlink{class_control__system}{Control\_system}}(\textcolor{comment}{/* args */});}
\DoxyCodeLine{99     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_control__system_ab7912068a11d44b07eef3b3f56ce0598}{notify\_observers}}() \textcolor{keyword}{override};}
\DoxyCodeLine{100     \textcolor{keywordtype}{float} measure\_temperature();}
\DoxyCodeLine{101     \textcolor{keywordtype}{int} measure\_moisture();}
\DoxyCodeLine{102     \textcolor{keywordtype}{void} set\_next\_step\_flag(\textcolor{keywordtype}{bool} new\_state);}
\DoxyCodeLine{103     \textcolor{keywordtype}{bool} is\_next\_step\_requested();}
\DoxyCodeLine{104     \textcolor{keywordtype}{void} set\_poll\_sensors\_flag(\textcolor{keywordtype}{bool} new\_state);}
\DoxyCodeLine{105     \textcolor{keywordtype}{bool} is\_poll\_sensors\_requested();}
\DoxyCodeLine{106     \textcolor{keywordtype}{void} set\_alarm\_flag(\textcolor{keywordtype}{bool} new\_state);}
\DoxyCodeLine{107     \textcolor{keywordtype}{bool} is\_alarm\_requested();}
\DoxyCodeLine{108     \textcolor{keywordtype}{void} request\_alarm(\mbox{\hyperlink{types_8h_a71ef44a7b1de581d625d82b37bed6c80}{ALARM\_TYPES}} type\_of\_alarm);}
\DoxyCodeLine{109     \textcolor{comment}{// void trigger\_buzzer\_alarm();}}
\DoxyCodeLine{110     \textcolor{keywordtype}{void} request\_warning(\mbox{\hyperlink{types_8h_a71ef44a7b1de581d625d82b37bed6c80}{ALARM\_TYPES}} type\_of\_warning);}
\DoxyCodeLine{111     \textcolor{keywordtype}{void} set\_warning\_flag(\textcolor{keywordtype}{bool} new\_state);}
\DoxyCodeLine{112     \textcolor{keywordtype}{bool} is\_warning\_requested();}
\DoxyCodeLine{113     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_control__system_ab3a3e36bda029f2a5d0c4ffdf8ff984c}{transition\_state}}();}
\DoxyCodeLine{114     \mbox{\hyperlink{struct_context__t}{Context\_t}} get\_context() \{ \textcolor{keywordflow}{return} this-\/>context; \};}
\DoxyCodeLine{115     \mbox{\hyperlink{class_control__system}{\string~Control\_system}}();}
\DoxyCodeLine{116     \textcolor{keywordtype}{bool} is\_next\_step\_overriden() \{ \textcolor{keywordflow}{return} this-\/>context.override\_next\_step; \};}
\DoxyCodeLine{117 }
\DoxyCodeLine{118 \textcolor{keyword}{private}:}
\DoxyCodeLine{119     \mbox{\hyperlink{struct_context__t}{Context\_t}} context;}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     \mbox{\hyperlink{class_display}{Display}} display;}
\DoxyCodeLine{122 }
\DoxyCodeLine{123     \mbox{\hyperlink{class_temperature__sensor}{Temperature\_sensor}} temp\_sensor;}
\DoxyCodeLine{124     \mbox{\hyperlink{class_buzzer}{Buzzer}} buzzer;}
\DoxyCodeLine{125     \mbox{\hyperlink{class_motor}{Motor}} motor;}
\DoxyCodeLine{126     \mbox{\hyperlink{class_moisture__sensor}{Moisture\_sensor}} mois\_sensor;}
\DoxyCodeLine{127     \mbox{\hyperlink{class_dual___l_e_d}{Dual\_LED}} motor\_status\_led;}
\DoxyCodeLine{128     \mbox{\hyperlink{class_cooler}{Cooler}} rear\_cooler;}
\DoxyCodeLine{129     \mbox{\hyperlink{class_cooler}{Cooler}} front\_cooler;}
\DoxyCodeLine{130 \};}
\DoxyCodeLine{131 }
\DoxyCodeLine{132 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
